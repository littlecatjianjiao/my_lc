package com.onething.dc;

import lombok.var;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.streaming.api.functions.source.SourceFunction;

/**
 * @ClassPath: com.onething.dc
 * @Description:
 * @Author: jiangchunyang
 * @Date: 2022/12/8
 */
public class apitest {
    public static void main(String[] args) throws Exception {
//        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
//        env.setParallelism(1);
//
//
//        var source = env.addSource(fixedTime2ReqAPi());
//        source.print();
//
//        env.execute("api test");

        System.out.println(1/2);
    }

    public static SourceFunction<String> fixedTime2ReqAPi(){
        return new SourceFunction<String>() {
            @Override
            public void run(SourceContext<String> sourceContext) throws Exception {
                String requetsIps = "219.157.230.204,223.65.40.229,39.85.32.176,118.250.174.148,106.35.119.98,106.41.247.196,112.3.117.233,110.184.45.196,36.113.163.196,183.46.231.59,218.86.226.52,111.35.185.66,223.246.42.136,120.239.71.67,113.231.109.194,111.122.186.202,123.7.15.224,111.36.171.183,125.36.118.41,106.8.4.90,106.113.114.214,182.133.24.110,219.146.198.238,171.36.90.92,119.0.204.87,106.114.45.127,42.232.104.212,117.188.146.195,121.205.172.203,111.19.53.14,36.157.162.128,182.134.90.150,36.4.62.173,121.230.12.38,112.96.182.7,120.244.130.165,223.97.178.150,125.127.244.148,171.43.195.114,42.232.245.237,117.60.41.245,180.169.208.226,223.12.76.215,223.87.39.158,223.157.124.253,27.193.103.16,123.234.65.162,110.183.23.119,221.231.199.134,113.129.119.32,183.199.218.64,218.86.218.22,39.171.146.117,27.227.23.7,116.136.212.156,14.122.131.137,60.182.59.45,27.154.68.175,60.217.212.142,183.39.158.106,111.27.36.79,123.53.50.22,183.198.85.70,180.119.19.82,117.11.242.99,36.23.121.93,36.62.245.250,101.17.42.196,111.121.82.96,36.63.114.207,223.152.157.208,223.12.162.202,110.255.93.65,113.249.167.252,219.145.167.66,117.89.44.144,118.182.67.230,1.189.23.204,183.202.21.209,171.213.52.136,101.29.180.123,42.176.138.76,122.243.62.55,14.23.208.95,101.83.39.190,1.58.42.242,116.95.84.145,36.18.229.121,183.216.204.120,123.144.234.187,123.179.168.86,42.230.218.133,36.45.16.62,101.75.42.160,223.154.89.79,171.215.217.147,113.218.8.216,120.7.95.101,27.227.135.172,110.250.179.184,59.34.145.183,111.193.223.154,112.44.117.112,60.161.171.84,219.155.219.122,223.90.214.140,14.204.172.239,113.2.201.194,171.91.128.18,182.34.50.98,58.19.4.7,223.96.249.150,1.69.113.59,120.7.18.181,139.170.246.192,101.87.39.175,120.219.147.82,36.161.108.170,106.117.44.52,120.245.24.216,120.219.119.113,27.128.89.17,42.88.19.106,183.228.188.144,183.208.134.226,183.250.125.231,171.44.107.91,117.188.10.8,183.250.210.1,113.117.185.178,112.24.117.179,119.54.117.148,120.216.253.137,119.191.13.43,171.221.152.95,218.89.127.126,183.150.182.244,117.154.58.214,120.33.17.238,183.157.106.33,122.238.173.147,222.209.103.109,110.228.230.153,121.16.71.232,111.121.93.157,101.74.61.98,42.203.34.194,221.216.56.229,1.30.251.42,110.52.67.161,123.133.201.234,27.26.9.210,117.65.171.83,183.37.160.2,110.152.95.107,223.244.126.147,111.85.43.205,180.162.28.59,117.182.41.204,222.135.69.61,123.149.49.52,183.9.205.199,110.52.162.52,39.73.90.95,113.245.73.67,183.190.121.130,222.141.227.174,113.71.60.225,124.92.86.171,175.9.82.48,223.146.82.227,220.200.104.91,223.79.202.108,117.189.47.251,222.221.134.140,27.154.2.183,113.101.43.163,112.38.11.148,110.53.205.55,183.251.161.98,114.101.31.21,113.141.112.220,112.0.162.202,113.127.29.201,42.234.29.90,223.90.178.20,111.72.183.40,120.243.51.71,42.234.96.124,121.18.150.242,61.186.22.30,223.157.119.75,116.16.244.0,39.154.166.253,219.136.0.143,182.97.232.222,112.20.225.135,39.187.234.50,180.116.162.94,122.227.55.90,139.205.166.100,61.148.243.51,36.48.46.12,223.149.251.168,36.143.61.152,171.90.24.80,61.159.1.15,114.229.215.195,39.188.124.60,223.153.85.0,36.106.55.214,221.9.55.185,183.217.161.161,123.115.121.172,112.24.116.145,223.246.54.215,122.238.174.218,39.149.249.36,115.60.159.175,117.162.199.173,182.111.207.189,115.239.181.14,106.119.2.108,123.13.11.61,39.163.192.193,112.47.172.27,120.219.16.134,117.154.253.174,115.60.179.97,60.221.49.142,113.2.201.87,223.149.110.35,113.133.110.235,223.79.12.17,222.217.125.101,111.164.39.52,120.14.71.156,117.176.74.138,122.243.183.45,120.216.254.194,111.16.142.137,106.127.106.122,120.244.184.54,117.153.112.196,221.9.103.33,183.160.219.31,120.242.160.218,117.152.241.21,113.78.252.140,122.247.158.187,183.229.199.63,39.163.25.186,124.229.121.202,218.93.132.173,106.57.248.191,49.78.178.127,112.18.231.140,121.27.229.58,218.12.207.74,120.192.8.114,114.93.35.32,36.148.53.20,1.194.107.192,106.42.168.230,119.182.3.212,221.200.27.56,39.154.168.32,39.148.116.151,106.110.167.2,125.79.24.85,113.143.48.186,171.212.110.33,58.219.180.60,101.93.199.9,118.74.227.211,36.148.58.8,120.70.131.220,58.208.40.119,117.162.164.83,59.51.226.59,117.153.2.127,183.250.64.111,180.107.130.172,110.181.4.247,183.199.159.89,122.7.36.89,111.49.205.149,106.115.122.21,171.89.73.128,116.53.34.225,183.230.47.179,119.182.12.34,223.91.38.224,36.46.113.217,60.162.41.130,112.239.239.83,180.162.93.222,14.134.5.210,14.214.14.64,120.230.62.68,183.217.83.133,36.63.88.219,182.203.145.122,124.205.122.121,182.39.49.49,1.49.122.29,115.53.102.180,58.56.64.2,223.157.185.189,219.157.36.140,183.245.54.9,111.173.156.162,27.220.238.161,183.198.132.55,171.40.60.117,111.9.127.24,180.212.98.223,117.183.251.228,183.209.147.61,117.12.181.113,183.225.39.72,183.17.61.141,123.175.156.239,117.167.37.62,121.8.50.86,120.244.158.4,115.50.12.123,27.189.22.125,111.29.81.51,120.231.8.115,223.74.115.64,111.14.88.76,183.46.36.27,106.61.209.230,150.255.157.73,113.16.251.214,27.14.110.135,14.153.238.146,113.111.28.160,111.43.155.239,49.88.145.71,112.37.202.193,117.150.200.116,171.83.10.65,123.113.231.182,182.141.144.231,112.38.35.176,111.182.64.211,39.149.219.57,210.76.45.166,42.229.254.67,60.14.75.190,117.173.79.185,39.186.178.138,14.205.125.31,140.75.193.5,117.183.215.64,121.17.50.158,120.219.150.217,182.246.138.114,39.148.234.37,112.9.219.158,111.16.117.122,125.44.88.171,183.224.195.221,112.38.124.27,113.66.216.221,1.82.50.6,115.52.154.12,120.239.207.110,117.165.204.10,220.207.93.3,183.95.250.200,112.41.24.104,120.10.71.227,223.72.67.108,42.87.21.26,116.178.63.197,27.226.31.65,180.105.119.254,120.229.104.162,106.44.6.165,125.122.246.86,112.36.106.245,182.138.96.59,183.197.61.223,183.157.55.215,111.60.196.21,223.72.80.211,111.23.200.202,113.102.120.178,183.200.160.18,113.83.46.77,101.83.71.61,111.47.12.206,140.243.57.179,140.250.242.212,58.213.87.10,117.13.117.2,1.84.93.110,223.87.169.92,223.91.12.45,183.252.79.82,36.157.233.125,39.173.59.22,112.50.39.146,219.135.174.236,222.29.18.83,183.226.193.55,112.24.164.190,113.109.196.132,223.96.112.40,14.127.250.3,118.213.17.120,111.162.152.250,183.54.233.163,116.252.60.243,219.152.128.243,118.250.113.228,112.47.113.43,183.252.238.144,39.70.122.4,119.85.97.215,14.106.92.148,27.199.223.243,182.114.4.45,112.244.230.172,1.29.82.195,39.144.159.116,221.13.57.52,175.5.192.155,120.231.20.21,171.94.180.157,27.27.189.127,123.165.137.167,182.97.128.215,221.223.49.69,113.69.168.213,1.71.237.75,182.245.83.70,222.191.212.193,58.20.50.202,60.222.54.8,36.44.140.114,123.185.43.178,111.36.163.22,60.177.164.140,117.188.47.164,36.59.18.56,39.168.85.156,111.192.169.125,110.18.91.113,223.98.72.117,218.67.165.180,112.96.100.121,113.120.18.231,116.23.91.34,124.133.80.177,112.32.93.83,113.58.33.187,124.228.100.10,61.180.104.9,115.230.232.15,120.208.227.189,111.183.102.187,123.144.57.99,27.148.54.63,183.198.40.253,183.250.42.185,36.61.6.57,27.197.187.94,36.20.119.147,171.119.235.162,153.101.168.81,183.227.232.76,110.85.22.57,111.172.200.196,171.9.33.55,111.75.3.59,111.194.220.9,112.96.183.54,112.42.57.127,106.61.43.217,27.201.88.5,112.3.175.90,222.212.105.17,111.49.38.45,120.229.246.75,119.177.49.121,222.216.167.239,117.139.134.240,113.77.145.77,223.101.91.236,1.29.91.143,123.186.232.101,183.165.228.18,123.163.217.42,14.156.36.55,183.208.232.100,117.37.104.95,114.239.96.58,121.27.249.224,223.104.41.97,124.117.92.51,175.43.185.94,153.118.163.113,61.166.195.221,183.194.162.112,183.197.2.92,125.85.205.100,39.86.105.77,113.119.179.186,115.57.147.155,112.45.245.247,112.64.68.238,36.1.71.189,183.200.214.134,223.89.128.244,114.100.36.31,39.183.147.206,27.226.20.241,180.125.19.152,117.154.7.77,113.133.133.154,112.112.114.207,112.37.48.223,27.18.102.203,117.176.249.172,180.104.85.112,120.192.13.53,220.166.236.89,120.229.95.208,101.70.137.18,27.149.36.80,39.77.237.72,106.114.62.34,42.93.25.118,221.15.131.32,39.160.163.72,139.207.196.173,27.186.173.120,112.32.198.107,223.104.95.91,42.86.166.54,117.173.16.55,113.79.170.202,121.24.122.53,111.174.65.138,120.239.75.3,120.243.239.143,223.67.255.143,1.60.212.171,117.189.58.242,27.225.254.141,27.128.15.23,183.46.95.109,36.46.182.186,223.114.208.161,223.246.102.98,175.163.83.153,223.107.130.91,171.123.65.139,115.152.23.133,101.16.240.91,120.216.241.249,114.102.192.120,36.28.176.22,60.5.164.55,124.239.240.119,60.210.142.59,39.188.223.152,113.220.58.131,183.197.154.181,39.144.64.240,118.74.93.215,118.251.4.88,175.2.29.126,171.216.47.153,27.189.76.38,223.74.207.65,27.197.121.105,117.189.62.253,182.34.221.52,112.3.88.108,113.73.152.112,112.114.34.42,123.160.122.104,113.220.38.196,223.71.12.144,42.94.168.73,113.2.172.12,39.180.84.233,182.141.89.71,183.8.139.190,42.234.240.22,183.200.6.96,42.234.6.47,221.230.120.108,111.58.190.137,183.199.108.195,223.115.2.44,60.186.40.124,183.53.190.35,106.119.214.188,60.18.99.76,120.231.125.230,27.189.92.58,113.132.53.136,36.42.236.248,112.37.144.219,111.225.106.114,171.13.243.204,183.209.148.236,223.98.99.253,120.208.246.39,223.73.70.246,182.111.52.0,27.17.190.207,122.5.106.138,27.47.2.202,120.242.116.208,123.54.27.169,27.213.2.153,111.25.141.222,119.117.153.76,183.198.88.83,101.71.216.53,223.96.252.186,113.222.55.153,36.157.94.8,183.253.240.109,61.186.20.225,119.187.103.202,171.218.125.52,120.230.200.245,171.34.222.43,106.122.182.144,39.187.122.240,183.210.4.1,222.247.75.125,183.196.204.17,111.127.38.155,183.58.13.237,42.178.46.33,27.37.2.245,139.170.92.203,119.190.166.252,121.32.47.6,218.85.59.202,223.12.223.143,111.18.115.145,113.71.199.124,113.231.15.7,121.57.240.64,120.244.34.193,36.182.48.10,42.230.70.180,36.142.171.76,39.144.75.130,218.86.232.61,106.47.158.62,116.8.42.243,112.37.148.1,27.184.140.43,111.35.229.17,42.177.160.29,115.60.167.235,180.98.155.220,116.252.167.226,110.244.94.243,59.175.107.60,171.93.21.31,153.34.83.166,182.133.228.155,59.41.144.51,183.251.25.120,122.247.150.187,123.118.52.122,49.93.79.241,106.35.148.152,223.87.252.35,218.3.211.250,111.58.218.193,39.128.224.106,218.69.52.140,223.104.202.68,27.194.56.215,58.21.118.147,139.207.118.195,223.95.50.102,221.232.51.116,182.108.122.165,42.93.159.205,120.85.245.135,116.114.160.142,221.194.222.74,183.9.197.68,171.94.231.3,111.60.180.8,116.252.43.8,39.149.164.146,182.106.104.64,180.107.194.239,112.38.108.173,39.87.60.133,223.79.253.224,36.162.191.132,49.90.177.121,112.51.129.241,1.206.4.150,222.94.208.46,116.31.178.43,182.116.18.80,125.87.28.171,36.132.164.89,14.213.137.37,183.200.29.70,223.102.23.100,27.187.118.247,120.216.150.114,182.204.222.230,113.222.65.170,222.90.54.214,123.13.248.178,59.172.107.206,111.46.50.73,117.186.1.14,27.200.196.234,58.45.38.170,39.144.153.228,106.61.230.247,223.68.56.242,27.198.141.251,171.90.63.37,112.249.203.125,115.49.91.253,115.54.251.178,112.32.130.17,221.237.150.224,117.95.142.191,171.127.220.9,111.183.106.142,223.11.176.37,110.7.218.53,175.163.34.98,106.44.153.22,60.9.112.235,106.112.20.107,42.94.227.10,171.208.22.141,120.229.152.179,39.163.52.91,123.135.143.116,220.195.64.230,218.83.102.90,120.208.79.50,36.112.206.36,113.12.216.167,123.122.134.250,31.208.31.215,117.151.61.50,117.153.187.156,222.221.184.61,171.121.254.8,112.117.79.194,222.78.58.60,223.112.31.85,111.16.61.32,27.199.52.54,111.226.17.164,223.99.164.118,39.187.225.132,112.251.235.16,112.32.81.51,125.112.191.183,39.72.19.237,111.17.68.209,49.93.65.150,112.96.119.135,219.157.65.152,42.238.92.104,42.234.131.31,182.147.62.74,115.224.225.14,36.148.189.49,112.40.49.193,182.136.36.126,39.71.151.142,117.94.45.7,218.79.252.129,117.43.156.248,39.81.251.237,183.132.59.105,122.6.185.2,223.104.106.172,119.181.188.114,36.7.210.111,111.196.213.135,112.48.56.180,27.17.249.23,223.74.120.166,116.5.33.12,27.186.1.35,120.227.192.161,222.172.157.131,117.179.207.242,39.144.102.76,211.93.235.246,118.181.184.219,112.66.37.178,42.184.95.105,39.148.154.157,36.158.97.23,153.0.6.211,120.239.179.77,111.35.89.191,106.34.50.153,36.6.37.195,116.76.20.105,101.87.132.119,42.63.51.239,117.141.217.1,120.228.132.33,220.195.65.55,183.228.88.66,111.18.133.48,36.148.71.140,36.28.229.171,223.157.164.103,111.224.163.178,112.0.20.86,61.242.128.34,180.109.93.111,14.150.92.184,106.111.43.164,111.164.3.56,124.239.221.182,117.177.17.99,123.183.164.211,61.170.131.10,171.88.44.205,120.219.112.17,113.86.246.134,222.247.221.122,112.39.79.242,117.141.22.123,182.46.145.148,180.115.154.134,183.208.0.194,121.26.220.215,115.171.52.77,113.239.169.193,112.41.59.172,223.90.140.248,171.43.231.72,112.115.16.94,1.190.251.124,112.237.98.89,122.140.116.17,115.50.188.88,119.250.42.81,111.15.199.217,101.224.227.183,118.254.185.102,117.188.16.220,116.228.121.106,183.92.127.152,112.12.197.231,112.92.71.139,36.161.83.138,111.197.20.102,115.58.227.244,119.181.11.240,223.157.154.148,117.154.153.36,60.212.212.168,117.24.108.65,183.208.250.165,223.68.227.169,36.42.18.190,114.254.214.14,112.9.20.38,183.197.84.25,171.113.238.0,120.207.69.32,222.137.239.53,42.227.20.10,112.19.231.18,223.102.88.114,117.158.220.125,39.160.164.229,27.26.238.252,171.210.212.164,106.61.18.109,112.224.142.111,14.119.195.253,111.182.83.190,116.116.253.253,223.85.169.108,101.90.7.2,183.206.46.114,183.4.27.114,223.146.11.210,218.62.84.98,223.104.27.19,39.172.118.247,182.140.97.121,183.226.69.151,222.95.120.69,61.179.121.184,222.137.167.236,101.229.165.41,60.219.137.234,121.239.119.242,182.123.59.154,60.223.252.53,106.109.51.240,140.243.75.128,111.201.22.78,219.136.10.89,14.108.198.239,39.128.210.178,49.93.74.73,1.30.89.204,113.132.222.253,120.239.102.250,139.227.235.123,221.218.140.33,42.91.169.253,122.156.35.172,125.80.141.45,106.112.85.51,106.87.97.204,116.115.1.40,61.52.16.24,36.4.161.150,106.116.106.128,60.163.242.128,27.19.5.125,60.170.156.196,114.102.139.238,112.32.78.120,111.25.108.126,223.96.237.55,120.224.242.56,180.136.165.63,39.184.69.81,39.89.117.211,117.175.176.24,27.9.32.92,121.16.165.159,36.184.24.204,113.129.237.234,42.87.95.27,120.219.124.151,1.26.125.227,39.149.190.88,183.229.211.47,180.98.34.11,183.199.160.132,144.12.153.12,112.44.76.106,180.141.221.124,49.70.130.29,117.135.84.72,218.29.6.73,112.2.80.93,120.235.20.214,118.114.168.173,116.20.165.187,110.152.89.75,117.136.89.34,36.158.112.55,58.254.40.242,116.25.42.214,115.229.246.227,117.28.168.174,171.212.34.253,1.30.87.28,101.24.205.208,218.21.162.124,120.242.107.57,223.157.210.164,116.1.119.189,101.249.202.12,112.37.115.5,120.10.44.169,58.47.203.2,101.80.156.83,49.72.77.12,42.86.106.231,117.178.82.223,122.143.179.37,123.54.24.64,182.124.39.144,111.17.134.15,117.155.165.88,120.219.96.89,42.84.9.108,49.89.134.78";
                String[] ipArr = requetsIps.split(",");

                for (String ip : ipArr){
                    String resJson = HttpUtils.requestK8sApi(ip,ipArr.length);
                    sourceContext.collect(resJson);
                }

            }

            @Override
            public void cancel() {
            }
        };
    }
}
